<!DOCTYPE html>
<html lang="en">
<head>
  <link rel="icon" type="image/x-icon" href="/OpenSpace-AppImage/favicon.ico">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>OpenSpace (unofficial) daily builds</title>
  <style>
    body {
      background-color: #0d1117;
      color: #ffffff;
      font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
      margin: 0;
      padding: 0;
      line-height: 1.6;
    }

    header {
      background-color: #161b22;
      padding: 1.5rem 2rem;
      text-align: center;
      border-bottom: 1px solid #30363d;
    }

    header h1 {
      margin: 0;
      font-size: 1.8rem;
      color: #ffffff;
    }

    main {
      max-width: 800px;
      margin: 2rem auto;
      padding: 0 1rem;
    }

    section {
      margin-bottom: 3rem;
    }

    h2 {
      color: #79c0ff;
      border-bottom: 1px solid #30363d;
      padding-bottom: 0.3rem;
    }

    a {
      color: #ffffff;
      text-decoration: none;
    }

    a:hover {
      color: #58eeff;
      text-decoration: underline;
    }

    ul {
      list-style: none;
      padding: 0;
    }

    li {
      background: #161b22;
      margin: 0.5rem 0;
      padding: 0.8rem;
      border: 1px solid #30363d;
      border-radius: 6px;
      display: flex;
      flex-wrap: wrap;
      justify-content: space-between;
      align-items: center;
    }

    .build-link {
      flex: 1 1 auto;
      word-break: break-all;
      position: relative; /* Established context for tooltip */
    }

    .workflow-link {
      flex: 0 0 auto;
      margin-left: 1rem;
      font-size: 0.9rem;
      color: #8b949e;
    }

    footer {
      text-align: center;
      padding: 2rem;
      font-size: 0.9rem;
      color: #8b949e;
      border-top: 1px solid #30363d;
    }

    /* --- Asset Date Styling Start --- */

    /* The element that holds the date text for Mobile view (hidden by default on desktop) */
    .mobile-date-info {
        display: none;
        font-size: 0.8rem;
        color: #8b949e;
        margin-top: 4px;
        font-style: italic;
    }

    /* Desktop Hover Tooltip Logic */
    @media (min-width: 769px) {
        /* Add tooltip via pseudo-element when data-last-updated is present */
        .asset-download-link[data-last-updated]:hover::after {
            content: attr(data-last-updated);
            position: absolute;
            left: 0;
            bottom: 100%; /* Position above the link */
            background-color: #21262d;
            color: #c9d1d9;
            padding: 5px 10px;
            border: 1px solid #30363d;
            border-radius: 6px;
            font-size: 0.85rem;
            white-space: nowrap;
            pointer-events: none;
            box-shadow: 0 4px 10px rgba(0,0,0,0.5);
            z-index: 100;
            margin-bottom: 5px;
        }
    }

    /* Mobile View Adjustments */
    @media (max-width: 768px) {
      li {
        flex-direction: column;
        align-items: flex-start;
      }
      .workflow-link {
        margin-left: 0;
        margin-top: 0.5rem;
      }
      
      /* On mobile, show the static date text instead of the hover tooltip */
      .mobile-date-info {
          display: block;
      }
    }
    /* --- Asset Date Styling End --- */
  </style>
</head>
<body>
  <header>
    <h1>OpenSpace (unofficial) daily builds</h1>
  </header>

  <main>
    <!-- Linux Section -->
    <section id="linux">
      <h2>Linux</h2>
      <ul>
        <li>
          <span class="build-link">
            <a class="asset-download-link" target=_blank href="https://github.com/hn-88/OpenSpace-AppImage/releases/download/daily-AppImage/OpenSpace-0.21.3+-1-daily-aarch64.AppImage">
              OpenSpace-0.21.3+-1-daily-aarch64.AppImage
            </a>
          </span>
          <span class="workflow-link">
            <a target=_blank href="https://github.com/hn-88/OpenSpace-AppImage/wiki/OpenSpace-AppImage%E2%80%90specific-documentation">documentation</a>
            &nbsp;&nbsp;
            <a target=_blank href="https://github.com/hn-88/OpenSpace-AppImage/blob/main/.github/workflows/arm64-appimage-daily.yml">workflow</a>
          </span>
        </li>

        <li>
          <span class="build-link">
            <a class="asset-download-link" target=_blank href="https://github.com/hn-88/OpenSpace-AppImage/releases/download/daily-AppImage/OpenSpace-0.21.3plus-1-daily-x86_64.AppImage">
              OpenSpace-0.21.3plus-1-daily-x86_64.AppImage
            </a>
          </span>
          <span class="workflow-link">
            <a target=_blank href="https://github.com/hn-88/OpenSpace-AppImage/wiki/OpenSpace-AppImage%E2%80%90specific-documentation">documentation</a>
            &nbsp;&nbsp;
            <a target=_blank href="https://github.com/hn-88/OpenSpace-AppImage/blob/main/.github/workflows/appimage-daily.yml">workflow</a>
          </span>
        </li>

        <li>
          <span class="build-link">
            <a class="asset-download-link" target=_blank href="https://github.com/hn-88/OpenSpace-AppImage/releases/download/daily-CPACK-DEB/openspace_0.21.3+.ubuntu22.04.1_amd64_daily.deb">
              openspace_0.21.3+.ubuntu22.04.1_amd64_daily.deb
            </a>
          </span>
          <span class="workflow-link">
            <a target=_blank href="https://github.com/hn-88/OpenSpace-AppImage/wiki/OpenSpace-deb%E2%80%90specific-documentation">documentation</a>
            &nbsp;&nbsp;
            <a target=_blank href="https://github.com/hn-88/OpenSpace-AppImage/blob/main/.github/workflows/deb-on-22.04wCpack.yml">workflow</a>
          </span>
        </li>

        <li>
          <span class="build-link">
            <a class="asset-download-link" target=_blank href="https://github.com/hn-88/OpenSpace-AppImage/releases/download/daily-CPACK-DEB/openspace_0.21.3+.ubuntu24.04_amd64_daily.deb">
              openspace_0.21.3+.ubuntu24.04_amd64_daily.deb
            </a>
          </span>
          <span class="workflow-link">
            <a target=_blank href="https://github.com/hn-88/OpenSpace-AppImage/wiki/OpenSpace-deb%E2%80%90specific-documentation">documentation</a>
            &nbsp;&nbsp;
            <a target=_blank href="https://github.com/hn-88/OpenSpace-AppImage/blob/main/.github/workflows/deb-on-24.04wCpack.yml">workflow</a>
          </span>
        </li>
      </ul>
    </section>

    <!-- Windows Section -->
    <section id="windows">
      <h2>Windows</h2>  
      <ul>
      <li><span class="build-link">
            <a class="asset-download-link" target=_blank href="https://github.com/hn-88/OpenSpace-AppImage/releases/download/daily-WIN-ZIP/OpenSpace-minimal-daily.zip">
              OpenSpace-minimal-daily.zip
            </a>
          </span>
          <span class="workflow-link">
            <a target=_blank href="https://docs.openspaceproject.com/latest/getting-started/install/index.html">documentation</a>
            &nbsp;&nbsp;
            <a target=_blank href="https://github.com/hn-88/OpenSpace-AppImage/blob/main/.github/workflows/windows-latest.yml">workflow</a>
          </span>
      </li>
      <li><span class="build-link">
            <a class="asset-download-link" target=_blank href="https://github.com/hn-88/OpenSpace-AppImage/releases/download/daily-WIN-ZIP/OpenSpace-minimal-single-precision.zip">
              OpenSpace-minimal-single-precision.zip
            </a>
          </span>
          <span class="workflow-link">
            <a target=_blank href="https://github.com/hn-88/OpenSpace-AppImage/wiki/OpenSpace-single-precision-Windows-build-documentation">documentation</a>
            &nbsp;&nbsp;
            <a target=_blank href="https://github.com/hn-88/OpenSpace-AppImage/blob/main/.github/workflows/windows-single-prec.yml">workflow</a>
          </span>
      </li>  
      </ul>
    </section>

    <!-- Mac Section -->
    <section id="mac">
      <h2>Mac</h2>
      <ul>
      <li><span class="build-link">
            <a class="asset-download-link" target=_blank href="https://github.com/hn-88/OpenSpace-AppImage/releases/download/daily-MacOS-app-single-precision/OpenSpace-minimal-daily-mac.zip">
              OpenSpace-minimal-daily-mac.zip
            </a>
          </span>
          <span class="workflow-link">
            <a target=_blank href="https://github.com/hn-88/OpenSpace-AppImage/wiki/OpenSpace-on-Mac">documentation</a>
            &nbsp;&nbsp;
            <a target=_blank href="https://github.com/hn-88/OpenSpace-AppImage/blob/main/.github/workflows/macos-26-arm64-single-precision-using-patcher.yml">workflow</a>
          </span>
      </li>
      </ul>
    </section>
    
    <!-- Other Builds Section -->
    <section id="other">
      <h2>Other Builds</h2>
      <ul>
      <li><span class="build-link">
            <!-- Note: This is not a direct download link, so it will be ignored by the JS logic -->
            <a target=_blank href="https://github.com/hn-88/OpenSpace-AppImage/releases">
              Some speciality builds like video-patched etc may be available
            </a>
          </span>
          <span class="workflow-link">
            <a target=_blank href="https://docs.openspaceproject.com/latest/getting-started/install/index.html">documentation</a>
            &nbsp;&nbsp;
            <a target=_blank href="https://github.com/hn-88/OpenSpace-AppImage/blob/main/.github/workflows">workflow</a>
          </span>
      </li>
      <li><span class="build-link">
            <a target=_blank href="https://github.com/hn-88/OpenSpace-single-precision/releases">
              Work-in-progress single-precision builds
            </a>
          </span>
          <span class="workflow-link">
            <a target=_blank href="https://github.com/hn-88/OpenSpace-single-precision/wiki">documentation</a>
            &nbsp;&nbsp;
            <a target=_blank href="https://github.com/hn-88/OpenSpace-single-precision/tree/main/.github/workflows">workflow</a>
          </span>
      </li>
      </ul>
    </section>
    
  </main>

  <footer>
    <p>These are unofficial builds of OpenSpace. Visit the official project at
      <a target=_blank href="https://openspaceproject.com">openspaceproject.com</a>. Official GitHub repository for the source code is <a target=_blank href="https://github.com/OpenSpace/OpenSpace">https://github.com/OpenSpace/OpenSpace</a>.
    </p>
  </footer>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
        // Cache to prevent duplicate API calls for the same tag
        const tagDataCache = {};

        // Helper to fetch data for a specific tag
        async function fetchTagData(user, repo, tag) {
            const cacheKey = `${user}/${repo}/${tag}`;
            
            if (tagDataCache[cacheKey]) {
                return tagDataCache[cacheKey];
            }

            try {
                const response = await fetch(`https://api.github.com/repos/${user}/${repo}/releases/tags/${tag}`);
                if (!response.ok) throw new Error('API Error');
                const data = await response.json();
                
                // Store promise or data in cache
                tagDataCache[cacheKey] = data;
                return data;
            } catch (error) {
                console.error(`Failed to fetch tag ${tag}:`, error);
                return null;
            }
        }

        // Helper to format date
        function formatDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleDateString('en-US', {
                year: 'numeric',
                month: 'short',
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            });
        }

        // Find all links that look like GitHub release downloads
        const links = document.querySelectorAll('a[href*="/releases/download/"]');

        links.forEach(async (link) => {
            // Regex to parse: https://github.com/USER/REPO/releases/download/TAG/FILENAME
            const githubRegex = /github\.com\/([^/]+)\/([^/]+)\/releases\/download\/([^/]+)\/(.+)/;
            const match = link.href.match(githubRegex);

            if (match) {
                const [_, user, repo, tag, filename] = match;
                
                // Create the mobile date element immediately (showing "Loading..." or hidden initially)
                const mobileInfo = document.createElement('div');
                mobileInfo.className = 'mobile-date-info';
                mobileInfo.textContent = 'Checking update time...';
                
                // Insert after the link (but inside the parent span .build-link if possible)
                if(link.parentNode.classList.contains('build-link')) {
                    link.parentNode.appendChild(mobileInfo);
                } else {
                    link.after(mobileInfo);
                }

                const data = await fetchTagData(user, repo, tag);

                if (data && data.assets) {
                    // Find the asset that matches the filename in the URL
                    // Note: URL decoding is handled automatically by browser for matching, 
                    // but we ensure we compare decoded strings just in case.
                    const asset = data.assets.find(a => a.name === decodeURIComponent(filename));
                    
                    if (asset && asset.updated_at) {
                        const dateStr = `Last updated: ${formatDate(asset.updated_at)}`;
                        
                        // 1. Update Desktop Hover (Title attribute or Custom Data attribute)
                        link.setAttribute('data-last-updated', dateStr);
                        
                        // 2. Update Mobile Text
                        mobileInfo.textContent = dateStr;
                    } else {
                        mobileInfo.textContent = 'Update time unavailable';
                    }
                } else {
                    mobileInfo.textContent = 'Update time unavailable';
                }
            }
        });
    });
  </script>
</body>
</html>